*** WifiConfiguration.smali	2013-11-18 12:22:09.030343269 +0800
--- WifiConfiguration.smali	2013-11-18 12:19:11.994339945 +0800
***************
*** 205,210 ****
  
      new-instance v5, Landroid/net/wifi/WifiConfiguration$EnterpriseField;
  
      const-string v6, "eap"
  
      invoke-direct {v5, p0, v6, v8}, Landroid/net/wifi/WifiConfiguration$EnterpriseField;-><init>(Landroid/net/wifi/WifiConfiguration;Ljava/lang/String;Landroid/net/wifi/WifiConfiguration$1;)V
--- 223,236 ----
  
      new-instance v5, Landroid/net/wifi/WifiConfiguration$EnterpriseField;
  
+     const-string v6, "private_key"
+ 
+     invoke-direct {v5, p0, v6, v8}, Landroid/net/wifi/WifiConfiguration$EnterpriseField;-><init>(Landroid/net/wifi/WifiConfiguration;Ljava/lang/String;Landroid/net/wifi/WifiConfiguration$1;)V
+ 
+     iput-object v5, p0, Landroid/net/wifi/WifiConfiguration;->private_key:Landroid/net/wifi/WifiConfiguration$EnterpriseField;
+ 
+     new-instance v5, Landroid/net/wifi/WifiConfiguration$EnterpriseField;
+ 
      const-string v6, "eap"
  
      invoke-direct {v5, p0, v6, v8}, Landroid/net/wifi/WifiConfiguration$EnterpriseField;-><init>(Landroid/net/wifi/WifiConfiguration;Ljava/lang/String;Landroid/net/wifi/WifiConfiguration$1;)V
***************
*** 465,470 ****
  
      new-instance v1, Landroid/net/wifi/WifiConfiguration$EnterpriseField;
  
      const-string v2, "eap"
  
      invoke-direct {v1, p0, v2, v3}, Landroid/net/wifi/WifiConfiguration$EnterpriseField;-><init>(Landroid/net/wifi/WifiConfiguration;Ljava/lang/String;Landroid/net/wifi/WifiConfiguration$1;)V
--- 491,504 ----
  
      new-instance v1, Landroid/net/wifi/WifiConfiguration$EnterpriseField;
  
+     const-string v2, "private_key"
+ 
+     invoke-direct {v1, p0, v2, v3}, Landroid/net/wifi/WifiConfiguration$EnterpriseField;-><init>(Landroid/net/wifi/WifiConfiguration;Ljava/lang/String;Landroid/net/wifi/WifiConfiguration$1;)V
+ 
+     iput-object v1, p0, Landroid/net/wifi/WifiConfiguration;->private_key:Landroid/net/wifi/WifiConfiguration$EnterpriseField;
+ 
+     new-instance v1, Landroid/net/wifi/WifiConfiguration$EnterpriseField;
+ 
      const-string v2, "eap"
  
      invoke-direct {v1, p0, v2, v3}, Landroid/net/wifi/WifiConfiguration$EnterpriseField;-><init>(Landroid/net/wifi/WifiConfiguration;Ljava/lang/String;Landroid/net/wifi/WifiConfiguration$1;)V
***************
*** 926,931 ****
      goto :goto_0
  
      :cond_3
      const/4 v0, 0x0
  
      goto :goto_0
--- 960,991 ----
      goto :goto_0
  
      :cond_3
+     iget-object v1, p0, Landroid/net/wifi/WifiConfiguration;->allowedKeyManagement:Ljava/util/BitSet;
+ 
+     const/4 v0, 0x5
+     
+     invoke-virtual {v1, v0}, Ljava/util/BitSet;->get(I)Z
+ 
+     move-result v1
+ 
+     if-eqz v1, :cond_miui_0
+ 
+     goto :goto_0
+ 
+     :cond_miui_0
+     iget-object v1, p0, Landroid/net/wifi/WifiConfiguration;->allowedKeyManagement:Ljava/util/BitSet;
+ 
+     const/4 v0, 0x6
+ 
+     invoke-virtual {v1, v0}, Ljava/util/BitSet;->get(I)Z
+ 
+     move-result v1
+ 
+     if-eqz v1, :cond_miui_1
+ 
+     goto :goto_0
+ 
+     :cond_miui_1
      const/4 v0, 0x0
  
      goto :goto_0
***************
*** 1440,1445 ****
      invoke-virtual {v9, v11}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
  
      :cond_11
      iget-object v1, p0, Landroid/net/wifi/WifiConfiguration;->enterpriseFields:[Landroid/net/wifi/WifiConfiguration$EnterpriseField;
  
      .local v1, arr$:[Landroid/net/wifi/WifiConfiguration$EnterpriseField;
--- 1500,1522 ----
      invoke-virtual {v9, v11}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
  
      :cond_11
+     invoke-virtual {v9, v14}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
+ 
+     iget-object v11, p0, Landroid/net/wifi/WifiConfiguration;->wapiPsk:Ljava/lang/String;
+ 
+     if-eqz v11, :cond_miui_0
+ 
+     const-string v11, " wapiPsk: "
+ 
+     invoke-virtual {v9, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+ 
+     move-result-object v11
+ 
+     const/16 v12, 0x2a
+     
+     invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;
+ 
+     :cond_miui_0
      iget-object v1, p0, Landroid/net/wifi/WifiConfiguration;->enterpriseFields:[Landroid/net/wifi/WifiConfiguration$EnterpriseField;
  
      .local v1, arr$:[Landroid/net/wifi/WifiConfiguration$EnterpriseField;
